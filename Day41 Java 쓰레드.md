<Day41- 0517>
<Java 쓰레드>

## 쓰레드

❤️ 프로세스와 쓰레드

1. 프로세스의 개념

   (1) 실행 중인 프로그램(program)
   (2) 프로그램을 수행하는 데 필요한 데이터와 메모리등의 자원 그리고 쓰레드로 구성
   (3) 프로세스의 자원을 이용해서 실제로 작업을 수행하는 것이 쓰레드임
   (4) 모든 프로세스에는 최소한 하나 이상의 쓰레드가 존재하며, 둘 이상의 쓰레드를 가진 프로세스를 멀티쓰레드 프로세스(multi-threaded process)라고 함
   (5) 프로세스의 메모리 한계에 따라 생성할 수 있는 쓰레드의 수가 결정됨

   쓰레드 : 작업 메서드(주 메서드) + 호출 스택 : 작업대 -> 이를 통해 함수가 수행
   작업 메서드 main : main 쓰레드
   쓰레드를 여러개 만들면 작업을 분담해서 나누어 할 수 있음

   main() -> 메인 쓰레드
   run() -> 사용자 정의 쓰레드 : 실행시 호출 스택이 필요하므로 별도 메서드 start() 실행 -> 호출스택 + run() 메서드 실행

2. 멀티쓰레딩

- 하나의 프로세스내에서 여러 쓰레드가 동시에 작업을 수행하는 것
- 쓰레드는 필요에 의해 여러개 만들 수 있음 (프로세스에 할당된 메모리 내에서)

3. 멀티쓰테딩의 장점

   (1) CPU의 사용률을 향상시킴
   (2) 자원을 보다 효율적으로 사용할 수 있음
   (3) 사용자에 대한 응답성이 향상됨
   (4) 작업이 분리되어 코드가 간결해짐

4. 멀티쓰레딩의 단점
   (1) 여러 쓰레드가 같은 프로세스 내에서 자원을 공유하면서 작업을 하기 때문에 발생할 수 있는 동기화(synchronization), 교착상태(deadlock)와 같은 문제를 고려해서 신중하게 프로그래밍해야 함
   (2) 서로의 작업을 착각하지 않도록 유의

❤️ 쓰레드의 구현과 실행

1. Thread 클래스를 상속받는 방법과 Runnable 인터페이스를 구현하는 방법

   (1) Thread 클래스 상속
   (2) Runnable 인터페이스를 구현 -> Thread 생성자 매개변수

2. Thread클래스를 상속받으면 다른 클래스를 상속받을 수 없기 때문에 Runnable 인터페이스를 구현하는 방법이 일반적임

3. 쓰레드의 실행 - start() / run()

   (1) start()와 run()

   - start() : 독립적인 호출 스택 + run() 실행 / 병렬적인 작업이 가능
   - run()만 호출하면 -> main 쓰레드에서 순차적으로 실행 (병렬적이 아님)
   - run()만 실행하면 main 쓰레드 안에서 실행되는 것인데, start()를 실행하면 독립적인 호출 스택을 하나 더 만들어서 병렬적인 작업이 가능하도록 만들어주는 것임
   - start() 를 실행하게 되면 독립적인 호출스택이 만들어지고, run()을 새로 만들어진 호출스택에 실어서 실행해줌

   (2) 실행중인 사용자 쓰레드가 하나도 없을 때 프로그램은 종료됨

❤️ Runnable 인터페이스를 상속받으면 Runnable 값으로 생성자 매개변수 넣어주면 run()이 자동으로 실행되고, Thread 클래스를 상속받으면 run() 재정의를 해야함.

❤️ 싱글쓰레드와 멀티쓰레드

- 시분할 방식 -> 시간을 분할하는 방식

1. 하나의 쓰레드로 두 작업을 처리하는 경우 한 작업을 마친 후에 다른 작업을 시작함

2. 두 개의 쓰레드로 작업하는 경우에는 짧은 시간동안 2개의 쓰레드가 번갈아 가면서 작업을 수행해서 동시에 두 작업이 처리되는 것과 같이 느끼게 함

3. 하나의 쓰레드로 두개의 작업을 수행한 시간과 두개의 쓰레드로 두 개의 작업을 수행한 시간은 거의 같음

4. 오히려 두 개의 쓰레드로 작업한 시안이 싱글쓰레드로 작업한 시간보다 더 걸리게 되는데, 쓰레드간의 작업 전환(context switching)에 시간이 걸리기 때문임

❤️ 쓰레드의 우선순위

1. 쓰레드 우선순위 지정하기

❤️ 쓰레드 그룹(thread group)

❤️ 데몬 쓰레드(daemon thread)

- 유령 쓰레드
- 대표적인 것이 가비지콜렉터
- 백그라운드에서 대기하다가 알게모르게 작업
- 현재 작업중인 쓰레드의 작업이 종료가 되면 함께 종료되는 쓰레드
- setDaemon(true)

❤️ 쓰레드의 실행제어

1. 쓰레드와 스케줄링과 관련된 메서드
2. 쓰레드의 상태
3. sleep(long millis)
4. interrupt()와 interrupted()
5. suspend(), resume(), stop()
6. yield()
7. join()

❤️ 쓰레드의 동기화

1. synchronized를 이용한 동기화

1) 메서드 전체를 임계영역으로 지정
2) 특정한 영역을 임계 영역으로 지정

2. volatile
