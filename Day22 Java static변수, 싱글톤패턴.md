<Day22 - 0418>
<JAVA static변수, 싱글톤패턴>

# static 변수

## static 변수란?

- 클래스 내부에 선언하여 클래스에서 공통으로 사용하는 변수
- static 변수, 정적변수, 클래스 변수 모두 같은 말이다!

- 정적변수라고 하는 이유?
  : 프로그램이 실행되면 끝날때까지 남아있기 때문. 생성되고 없어지고를 반복하는 것이 아니라 고정적으로 있다가 프로그램이 끝나면 사라짐
- 클래스변수라고 하는 이유?
  : 인스턴스마다 생성되는 변수가 아닌 (new를 통해 생성되는 것이 아닌) 클래스에 속해 프로그램이 실행되면 처음 한번만 생성되는 변수이고, 이를 여러 인스턴스가 공유하기 때문임

## static 변수의 사용?

- 자료형 앞에 static 예약어를 붙여서 사용함
- static int 변수이름;

## static 변수의 가장 큰 특징?

- ★ static 변수는 프로그램이 실행되어 메모리에 올라갔을 때 딱 한번만 메모리 공간이 할당됨. 그 값은 모든 인스턴스가 공유할 수 있음 ★

## static 변수의 또다른 특징?

- static 변수는 인스턴스 생성과는 별개이므로 인스턴스보다 먼저 생성됨. 그러므로 인스턴스가 아닌 클래스 이름으로 참조하여 사용할 수 있음

## 일반 멤버변수와 static 변수의 차이점?

- 일반 멤버변수는 인스턴스가 생성될때마다 새로 생성됨 (함수가 끝나면 사라져버림)
- static 변수는 인스턴스 생성(객체 생성)과 상관 없이 프로그램이 실행될 때 먼저 생성됨

## static 변수의 장점?

- static 변수는 여러 인스턴스간에 공통으로 사용할 값이 필요한 경우 유용함. (매번 새로 생성하는 것은 노력이 많이 들고 메모리를 불필요하게 소비하게 되므로)
- static 변수가 클래스 전반에서 공통으로 사용할 수 있는 기준 변수가 되어줌

## static 변수의 살짝 불편한점?

- 동일한 메모리에 있는 하나의 주소값을 가지고 공유하기 때문에 변수 값을 바꾸어 버리면 바뀐 값으로 출력이 됨

## static 메서드 또는 클래스 메서드 (같은 이름임)

- static 메서드를 사용할때는 외부 클래스에서 static변수를 직접 참조하지 못하도록 일단 private로 선언함 (외부 클래스에서 static메서드를 건드려버리면 내부 클래스에서 사용하기 어려우니까)
- 그리고 이 변수에 대한 get() 메서드와 set() 메서드를 생성함(클래스 내부에서 사용하기 위해)

## static 메서드(클래스 메서드)와 인스턴스 변수

- static 메서드 내부에서는 인스턴스 변수를 사용할 수 없음
- static 변수, static 메서드 (클래스 변수, 클래스 매서드)는 인스턴스가 생성되지 않아도 사용할 수 있는 것과 관련이 있음
- static 메서드는 인스턴스 생성과 전혀 관련이 없고, 인스턴스 생성 이전에 생성됨. 그러므로 인스턴스 변수가 생성되었는지, 생성되지 않았는지 여부를 모르기 때문에 사용이 불가함 (인스턴스 변수는 인스턴스가 생성되어야 사용할 수 있는데, static 메서드는 생성되어 있어도 인스턴스와 인스턴스 변수는 생성되어 있지 않을 수도 있기 때문에 사용이 어려움)
- 반대로 일반 메서드에서 static 변수를 사용하는 것은 전혀 문제되는 것 없이 가능함(일반 메서드는 인스턴스가 생성될 때 호출되는 메서드이고, static 변수는 그 전에 이미 만들어진 변수이기 때문에 사용이 가능)

# 싱글톤 패턴

## 싱글톤 패턴이란?

- 객체지향 프로그램에서 인스턴스를 단 하나만 생성하는 디자인 패턴 (프로그램 전반에서 사용하는 인스턴스를 하나만 구현하는 방식)
- 메모리를 절약하는 방법의 패턴(한개를 가지고 공유하는 방식이므로)
- 기능 모음 클래스의 경우는 객체를 여러개 생성할 필요가 없음. 하나만 만들어 놓고 공유하면 되니깐

## 싱글톤 패턴으로 클래스 구현하는 방법

1. 생성자를 private로 만들기

   ```Java
   public class Company {
     private Company(){} // private으로 생성자 만들기
   }
   ```

   : 컴파일러가 자동으로 디폴트 생성자를 public으로 만들어버리는 것을 방지하기 위함
   : 생성자가 public이면 외부 클래스에서 인스턴스를 여러개 만들어 버릴 수도 있으므로 pirvate로 미리 선언
   : 인스턴스를 단 하나만 생성하는 디자인 패턴인데, 외부에서 여러개를 만들어 버리면 안되니까! 내부에서만 이 클래스를 제어해야 함
   : 그래서 싱글톤 패턴에서는 생성자를 반드시 명시적으로 private로 지정해야 함

2. 클래스 내부에 static으로 유일한 인스턴스(객체) 생성하기

   ```Java
   public class Company {
     private static Company instance = new Company(); // 유일한 인스턴스 생성
     private Company(){} // private으로 생성자 만들기
   }
   ```

   : 외부에서 인스턴스를 여러개 만들어버리지 못하도록 private로 막은 뒤 클래스 내부에서 사용할 유일한 인스턴스를 생성함
   : 이 인스턴스가 바로 프로그램 전체에서 사용할 유일한 인스턴스가 됨
   : 이 인스턴스 또한 private으로 선언해야지 외부에서 접근해 오류를 발생시키는 것을 방지할 수 있음

3. 외부에서 참조할 수 있는 public 메서드 만들기

   ```Java
   public class Company {
     private static Company instance = new Company(); // 유일한 인스턴스 생성
     private Company(){} // private으로 생성자 만들기

     public static Company getInstance() {
       if (instance == null) {
         instance = new Company();
       }
       return instance; // 유일하게 생성한 인스턴스 반환
     }
   }
   ```

   : private으로 선언한 유일한 인스턴스를 외부에서도 사용할 수 있도록 설정함(만들었으니 이제 외부에서 사용할 수 있도록 해주어야 함)
   : 외부에서 사용할 수 있도록 public 메서드 생성
   : 생성한 public 메서드에 유일하게 생성한 인스턴스를 반환
   : 이때 인스턴스를 반환하는 메서드는 반드시 static으로 선언! (인스턴스 생성과 상관없이 호출할 수 있도록 해야 하므로)

   \*\* 싱글톤 패턴은 필요할때 그 시기에 객체를 생성하여 공유할 수도 있음(처음부터 생성해 놓았는데 쓰지 않으면 메모리 낭비이므로)

(참고)
싱글톤패턴

목적: 메모리절약
정의 : 필요한 시점에 최초에 한번 생성하고 공유하는 패턴

- 객체 생성을 여러개 할 필요가 있는 경우? 데이터 클래스
- 객체 생성을 여러개 할 필요가 없는 경우? 기능을 담당하는 클래스

(참고)
싱글톤패턴 질문

[싱글톤패턴에서 클래스 내부에 static으로 유일한 인스턴스(객체)를 생성하는 이유?]

- 외부에서 인스턴스를 여러개 만들어버리지 못하도록 private로 막은 뒤 클래스 내부에서 사용할 유일한 인스턴스를 생성함 (외부에서 접근하는 것을 통제함)

- 이 인스턴스가 바로 프로그램 전체에서 사용할 유일한 인스턴스가 됨

- 싱글톤 패턴 자체가 객체지향 프로그램에서 인스턴스를 단 하나만 생성하는 디자인 패턴 (프로그램 전반에서 사용하는 인스턴스를 하나만 구현하는 방식)이기 때문에 인스턴스를 하나만 생성함

- (기능을 담당하는 클래스이기 때문. 기능을 굳이 여러 개 만들 필요가 없기 때문이다)

- 싱글톤패턴 내에서 인스턴스를 반환하는 메서드는 static으로 선언해야지 외부에서도 공유 가능함. 왜나하면 new로 객체를 생성하지 못하기 때문임(private으로 막혀 있는 상태)

- 그리고 static 메서드는 정적인 자원만 접근이 가능하므로 변수도 static으로 정의해야함
